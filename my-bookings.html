<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–∏ –∑–∞–ø–∏—Å–∏ - Melody Masters</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- Header (—Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ –≤ index.html) -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span>üéµ Melody Masters</span>
                </div>
                <nav>
                    <ul>
                        <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="about.html">–û –Ω–∞—Å</a></li>
                        <li><a href="lessons.html">–£—Ä–æ–∫–∏</a></li>
                        <li><a href="teachers.html">–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</a></li>
                        <li><a href="booking.html">–ó–∞–ø–∏—Å—å</a></li>
                        <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                    </ul>
                </nav>
                <div class="auth-buttons">
                    <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç–æ–º -->
                </div>
            </div>
        </div>
    </header>

    <!-- My Bookings Hero -->
    <section class="page-hero">
        <div class="container">
            <h1>–ú–æ–∏ –∑–∞–ø–∏—Å–∏</h1>
            <p>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤–∞—à–∏–º–∏ —É—Ä–æ–∫–∞–º–∏ –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º</p>
        </div>
    </section>

    <!-- Bookings Content -->
    <section class="bookings-content">
        <div class="container">
            <div id="bookingsList">
                <!-- –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å -->
            </div>
            
            <div id="noBookingsMessage" class="no-bookings" style="display: none;">
                <h2>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –Ω–∞ —É—Ä–æ–∫–∏</h2>
                <p>–ó–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –≤–∞—à –ø–µ—Ä–≤—ã–π —É—Ä–æ–∫ –∏ –Ω–∞—á–Ω–∏—Ç–µ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ!</p>
                <a href="booking.html" class="btn btn-primary">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É—Ä–æ–∫</a>
            </div>
        </div>
    </section>

    <!-- Footer (—Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ –≤ index.html) -->
    <footer>
        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ—É—Ç–µ—Ä–∞ -->
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (—Ç–∞–∫–∏–µ –∂–µ –∫–∞–∫ –≤ index.html) -->
    <div id="loginModal" class="modal">
        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—Ö–æ–¥–∞ -->
    </div>

    <div id="registerModal" class="modal">
        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    </div>

    <script src="js/script.js"></script>
    <script src="js/auth.js"></script>
    <script>
        // –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            
            if (!currentUser || !currentUser.isLoggedIn) {
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–∞—à–∏ –∑–∞–ø–∏—Å–∏.');
                document.getElementById('loginModal').style.display = 'block';
                return;
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            loadUserBookings(currentUser.email);
        });
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–ø–∏—Å–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserBookings(userEmail) {
            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
            const userBookings = bookings.filter(booking => booking.userId === userEmail);
            
            const bookingsList = document.getElementById('bookingsList');
            const noBookingsMessage = document.getElementById('noBookingsMessage');
            
            if (userBookings.length === 0) {
                bookingsList.style.display = 'none';
                noBookingsMessage.style.display = 'block';
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∑–∞–ø–∏—Å–∏ –ø–æ –¥–∞—Ç–µ (—Å–Ω–∞—á–∞–ª–∞ –±–ª–∏–∂–∞–π—à–∏–µ)
            userBookings.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            let bookingsHTML = '<h2>–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ —É—Ä–æ–∫–∏</h2>';
            
            userBookings.forEach(booking => {
                const bookingDate = new Date(booking.date);
                const now = new Date();
                
                // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—à–µ–¥—à–∏–µ —É—Ä–æ–∫–∏
                if (bookingDate < now) return;
                
                const instrumentNames = {
                    'piano': '–§–æ—Ä—Ç–µ–ø–∏–∞–Ω–æ',
                    'guitar': '–ì–∏—Ç–∞—Ä–∞',
                    'violin': '–°–∫—Ä–∏–ø–∫–∞',
                    'drums': '–£–¥–∞—Ä–Ω—ã–µ',
                    'vocal': '–í–æ–∫–∞–ª'
                };
                
                const teacherNames = {
                    '1': '–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞',
                    '2': '–ò–≤–∞–Ω –°–∏–¥–æ—Ä–æ–≤',
                    '3': '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞',
                    '4': '–î–º–∏—Ç—Ä–∏–π –ö–æ–∑–ª–æ–≤',
                    '5': '–ï–ª–µ–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞'
                };
                
                const lessonTypeNames = {
                    'individual': '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π',
                    'group': '–ì—Ä—É–ø–ø–æ–≤–æ–π'
                };
                
                bookingsHTML += `
                    <div class="booking-card">
                        <div class="booking-info">
                            <h3>${instrumentNames[booking.instrument]}</h3>
                            <p><strong>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:</strong> ${teacherNames[booking.teacher]}</p>
                            <p><strong>–¢–∏–ø —É—Ä–æ–∫–∞:</strong> ${lessonTypeNames[booking.lessonType]}</p>
                            <p><strong>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</strong> ${bookingDate.toLocaleDateString('ru-RU')} –≤ ${booking.time}</p>
                            ${booking.notes ? `<p><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:</strong> ${booking.notes}</p>` : ''}
                        </div>
                        <div class="booking-actions">
                            <button class="btn btn-outline" onclick="cancelBooking('${booking.id}')">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                            <button class="btn btn-primary" onclick="rescheduleBooking('${booking.id}')">–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏</button>
                        </div>
                    </div>
                `;
            });
            
            bookingsList.innerHTML = bookingsHTML;
            bookingsList.style.display = 'block';
            noBookingsMessage.style.display = 'none';
        }
        
        // –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–∏
        function cancelBooking(bookingId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å?')) {
                const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
                const updatedBookings = bookings.filter(booking => booking.id !== bookingId);
                localStorage.setItem('bookings', JSON.stringify(updatedBookings));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                loadUserBookings(currentUser.email);
                
                alert('–ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ –æ—Ç–º–µ–Ω–µ–Ω–∞.');
            }
        }
        
        // –ü–µ—Ä–µ–Ω–æ—Å –∑–∞–ø–∏—Å–∏
        function rescheduleBooking(bookingId) {
            alert('–§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –∑–∞–ø–∏—Å–∏ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.');
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã —Ñ–æ—Ä–º–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–æ–≤–æ–π –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏
        }
    </script>
</body>
</html>